Las reflexiones correspondientes a esta parte las he ido comentando en el codigo.
